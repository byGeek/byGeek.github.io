<!DOCTYPE html>












  


<html class="theme-next mist use-motion" lang="zh-CN">
<head><meta name="generator" content="Hexo 3.9.0">
  <meta charset="UTF-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=2">
<meta name="theme-color" content="#222">












<meta http-equiv="Cache-Control" content="no-transform">
<meta http-equiv="Cache-Control" content="no-siteapp">






















<link href="/lib/font-awesome/css/font-awesome.min.css?v=4.6.2" rel="stylesheet" type="text/css">

<link href="/css/main.css?v=6.4.0" rel="stylesheet" type="text/css">


  <link rel="apple-touch-icon" sizes="180x180" href="/favicon-64x64.png?v=6.4.0">


  <link rel="icon" type="image/png" sizes="32x32" href="/favicon-32x32.png?v=6.4.0">


  <link rel="icon" type="image/png" sizes="16x16" href="/favicon-16x16.png?v=6.4.0">


  <link rel="mask-icon" href="/favicon-128x128.png?v=6.4.0" color="#222">









<script type="text/javascript" id="hexo.configurations">
  var NexT = window.NexT || {};
  var CONFIG = {
    root: '/',
    scheme: 'Mist',
    version: '6.4.0',
    sidebar: {"position":"right","display":"post","offset":12,"b2t":false,"scrollpercent":false,"onmobile":false},
    fancybox: false,
    fastclick: false,
    lazyload: false,
    tabs: true,
    motion: {"enable":true,"async":false,"transition":{"post_block":"fadeIn","post_header":"slideDownIn","post_body":"slideDownIn","coll_header":"slideLeftIn","sidebar":"slideUpIn"}},
    algolia: {
      applicationID: '',
      apiKey: '',
      indexName: '',
      hits: {"per_page":10},
      labels: {"input_placeholder":"Search for Posts","hits_empty":"We didn't find any results for the search: ${query}","hits_stats":"${hits} results found in ${time} ms"}
    }
  };
</script>


  




  <meta name="description" content="在开发中，对版本号进行管理是一个很重要的事情。特别在visual studio中有多个project的时候，每一个project都有自己的version。下面介绍三种方式来实现版本号自动化管理。">
<meta name="keywords" content="Automatic Versions,version">
<meta property="og:type" content="article">
<meta property="og:title" content="visual studio中版本号自动管理">
<meta property="og:url" content="https://bygeek.cn/2018/04/04/automatic-versionning-in-visual-studio/index.html">
<meta property="og:site_name" content="萝卜头的日志">
<meta property="og:description" content="在开发中，对版本号进行管理是一个很重要的事情。特别在visual studio中有多个project的时候，每一个project都有自己的version。下面介绍三种方式来实现版本号自动化管理。">
<meta property="og:locale" content="zh-CN">
<meta property="og:image" content="https://bygeek.cn/2018/04/04/automatic-versionning-in-visual-studio/strong_named_assembly.png">
<meta property="og:image" content="https://bygeek.cn/2018/04/04/automatic-versionning-in-visual-studio/version.png">
<meta property="og:image" content="https://bygeek.cn/2018/04/04/automatic-versionning-in-visual-studio/add_as_link.png">
<meta property="og:image" content="https://bygeek.cn/2018/04/04/automatic-versionning-in-visual-studio/pre_build.png">
<meta property="og:image" content="https://bygeek.cn/2018/04/04/automatic-versionning-in-visual-studio/clip_image001.png">
<meta property="og:image" content="https://bygeek.cn/2018/04/04/automatic-versionning-in-visual-studio/clip_image002.png">
<meta property="og:image" content="https://bygeek.cn/2018/04/04/automatic-versionning-in-visual-studio/on_demand.png">
<meta property="og:updated_time" content="2020-01-31T16:23:02.527Z">
<meta name="twitter:card" content="summary">
<meta name="twitter:title" content="visual studio中版本号自动管理">
<meta name="twitter:description" content="在开发中，对版本号进行管理是一个很重要的事情。特别在visual studio中有多个project的时候，每一个project都有自己的version。下面介绍三种方式来实现版本号自动化管理。">
<meta name="twitter:image" content="https://bygeek.cn/2018/04/04/automatic-versionning-in-visual-studio/strong_named_assembly.png">



  <link rel="alternate" href="/atom.xml" title="萝卜头的日志" type="application/atom+xml">




  <link rel="canonical" href="https://bygeek.cn/2018/04/04/automatic-versionning-in-visual-studio/">



<script type="text/javascript" id="page.configurations">
  CONFIG.page = {
    sidebar: "",
  };
</script>

  <title>visual studio中版本号自动管理 | 萝卜头的日志</title>
  









  <noscript>
  <style type="text/css">
    .use-motion .motion-element,
    .use-motion .brand,
    .use-motion .menu-item,
    .sidebar-inner,
    .use-motion .post-block,
    .use-motion .pagination,
    .use-motion .comments,
    .use-motion .post-header,
    .use-motion .post-body,
    .use-motion .collection-title { opacity: initial; }

    .use-motion .logo,
    .use-motion .site-title,
    .use-motion .site-subtitle {
      opacity: initial;
      top: initial;
    }

    .use-motion {
      .logo-line-before i { left: initial; }
      .logo-line-after i { right: initial; }
    }
  </style>
</noscript>

</head>

<body itemscope itemtype="http://schema.org/WebPage" lang="zh-CN">

  
  
    
  

  <div class="container sidebar-position-right page-post-detail">
    <div class="headband"></div>

    <header id="header" class="header" itemscope itemtype="http://schema.org/WPHeader">
      <div class="header-inner"><div class="site-brand-wrapper">
  <div class="site-meta ">
    

    <div class="custom-logo-site-title">
      <a href="/" class="brand" rel="start">
        <span class="logo-line-before"><i></i></span>
        <span class="site-title">萝卜头的日志</span>
        <span class="logo-line-after"><i></i></span>
      </a>
    </div>
    
  </div>

  <div class="site-nav-toggle">
    <button aria-label="切换导航栏">
      <span class="btn-bar"></span>
      <span class="btn-bar"></span>
      <span class="btn-bar"></span>
    </button>
  </div>
</div>



<nav class="site-nav">
  
    <ul id="menu" class="menu">
      
        
        
        
          
          <li class="menu-item menu-item-home">
    <a href="/" rel="section">
      <i class="menu-item-icon fa fa-fw fa-home"></i> <br>首页</a>
  </li>
        
        
        
          
          <li class="menu-item menu-item-archives">
    <a href="/archives/" rel="section">
      <i class="menu-item-icon fa fa-fw fa-archive"></i> <br>归档</a>
  </li>
        
        
        
          
          <li class="menu-item menu-item-categories">
    <a href="/categories/" rel="section">
      <i class="menu-item-icon fa fa-fw fa-th"></i> <br>分类</a>
  </li>
        
        
        
          
          <li class="menu-item menu-item-tags">
    <a href="/tags/" rel="section">
      <i class="menu-item-icon fa fa-fw fa-tags"></i> <br>标签</a>
  </li>

      
      
        <li class="menu-item menu-item-search">
          
            <a href="javascript:;" class="popup-trigger">
          
            
              <i class="menu-item-icon fa fa-search fa-fw"></i> <br>搜索</a>
        </li>
      
    </ul>
  

  
    

  

  
    <div class="site-search">
      
  <div class="popup search-popup local-search-popup">
  <div class="local-search-header clearfix">
    <span class="search-icon">
      <i class="fa fa-search"></i>
    </span>
    <span class="popup-btn-close">
      <i class="fa fa-times-circle"></i>
    </span>
    <div class="local-search-input-wrapper">
      <input autocomplete="off" placeholder="搜索..." spellcheck="false" type="text" id="local-search-input">
    </div>
  </div>
  <div id="local-search-result"></div>
</div>



    </div>
  
</nav>



  



</div>
    </header>

    


    <main id="main" class="main">
      <div class="main-inner">
        <div class="content-wrap">
          
          <div id="content" class="content">
            

  <div id="posts" class="posts-expand">
    

  

  
  
  

  
    <div class="reading-progress-bar"></div>
  

  <article class="post post-type-normal" itemscope itemtype="http://schema.org/Article">
  
  
  
  <div class="post-block">
    <link itemprop="mainEntityOfPage" href="https://bygeek.cn/2018/04/04/automatic-versionning-in-visual-studio/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="name" content="byGeek">
      <meta itemprop="description" content="Never too late to lose weight!!!">
      <meta itemprop="image" content="/uploads/avatar.jpg">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="萝卜头的日志">
    </span>

    
      <header class="post-header">

        
        
          <h2 class="post-title" itemprop="name headline">visual studio中版本号自动管理
              
            
          </h2>
        

        <div class="post-meta">
          <span class="post-time">

            
            
            

            
              <span class="post-meta-item-icon">
                <i class="fa fa-calendar-o"></i>
              </span>
              
                <span class="post-meta-item-text">发表于</span>
              

              
                
              

              <time title="创建时间：2018-04-04 09:13:35" itemprop="dateCreated datePublished" datetime="2018-04-04T09:13:35+08:00">2018-04-04</time>
            

            
              

              
                
                <span class="post-meta-divider">|</span>
                

                <span class="post-meta-item-icon">
                  <i class="fa fa-calendar-check-o"></i>
                </span>
                
                  <span class="post-meta-item-text">更新于</span>
                
                <time title="修改时间：2020-02-01 00:23:02" itemprop="dateModified" datetime="2020-02-01T00:23:02+08:00">2020-02-01</time>
              
            
          </span>

          
            <span class="post-category">
            
              <span class="post-meta-divider">|</span>
            
              <span class="post-meta-item-icon">
                <i class="fa fa-folder-o"></i>
              </span>
              
                <span class="post-meta-item-text">分类于</span>
              
              
                <span itemprop="about" itemscope itemtype="http://schema.org/Thing"><a href="/categories/coding/" itemprop="url" rel="index"><span itemprop="name">coding</span></a></span>

                
                
              
            </span>
          

          
            
              <span class="post-comments-count">
                <span class="post-meta-divider">|</span>
                <span class="post-meta-item-icon">
                  <i class="fa fa-comment-o"></i>
                </span>
                <a href="/2018/04/04/automatic-versionning-in-visual-studio/#comments" itemprop="discussionUrl">
                  <span class="post-meta-item-text">评论数：</span> <span class="post-comments-count valine-comment-count" data-xid="/2018/04/04/automatic-versionning-in-visual-studio/" itemprop="commentCount"></span>
                </a>
              </span>
            
          

          
          

          

          

          

        </div>
      </header>
    

    
    
    
    <div class="post-body" itemprop="articleBody">

      
      

      
        <p>在开发中，对版本号进行管理是一个很重要的事情。特别在visual studio中有多个project的时候，每一个project都有自己的version。下面介绍三种方式来实现版本号自动化管理。</p>
<a id="more"></a>
<h2 id="前言"><a href="#前言" class="headerlink" title="前言"></a>前言</h2><p>先简单介绍下在visual studio中的三个version。</p>
<ul>
<li><p>Assembly Version</p>
<blockquote>
<p>.net CLR加载DLL的时候使用的版本号，如果加载强签名的dll，需要指定dll的版本号，就是这个Assembly Version</p>
</blockquote>
</li>
<li><p>Assembly File Version</p>
<blockquote>
<p>在windows 资源管理器中显示的文件版本号</p>
</blockquote>
</li>
<li><p>Assembly Info Version</p>
<blockquote>
<p>在windows 资源管理器中显示的产品版本号</p>
</blockquote>
</li>
</ul>
<img src="/2018/04/04/automatic-versionning-in-visual-studio/strong_named_assembly.png">
<img src="/2018/04/04/automatic-versionning-in-visual-studio/version.png">
<h2 id="利用VS自带的版本号递增"><a href="#利用VS自带的版本号递增" class="headerlink" title="利用VS自带的版本号递增"></a>利用VS自带的版本号递增</h2><p>在project的AssemblyInfo.cs文件中，可以使用通配符来使得版本号自动变化。</p>
<figure class="highlight csharp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// Version information for an assembly consists of the following four values:</span></span><br><span class="line"><span class="comment">//</span></span><br><span class="line"><span class="comment">//      Major Version</span></span><br><span class="line"><span class="comment">//      Minor Version </span></span><br><span class="line"><span class="comment">//      Build Number</span></span><br><span class="line"><span class="comment">//      Revision</span></span><br><span class="line"><span class="comment">//</span></span><br><span class="line"><span class="comment">// You can specify all the values or you can default the Build and Revision Numbers </span></span><br><span class="line"><span class="comment">// by using the '*' as shown below:</span></span><br><span class="line"><span class="comment">// [assembly: AssemblyVersion("1.0.*")]</span></span><br><span class="line">[<span class="meta">assembly: AssemblyVersion(<span class="meta-string">"1.0.*"</span>)</span>]</span><br><span class="line"><span class="comment">//[assembly: AssemblyFileVersion("1.0.0.0")]  注释掉该行</span></span><br></pre></td></tr></table></figure>
<p>这样每次成功build之后，assembly version ，File version都会变化，其中build number和revision是以某个时间节点为起点，到build时计算出来的值。</p>
<p>在vs中，每个project都有一个AssemblyInfo.cs文件，在多个project之间，可以通过共享文件来共享同一个版本号。</p>
<ul>
<li><p>首先将所有project的AssemblyInfo.cs文件中的AssemblyVersion和AssemblyFileVersion注释掉</p>
</li>
<li><p>在你的启动工程中创建一个SharedInfo.cs，加入以下内容:</p>
<figure class="highlight csharp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">using</span> System.Reflection;</span><br><span class="line"></span><br><span class="line">[<span class="meta">assembly: AssemblyVersion(<span class="meta-string">"1.0.*"</span>)</span>]</span><br></pre></td></tr></table></figure>
</li>
<li><p>在其他project中将上一步创建的文件通过add as link方式add进来。</p>
<img src="/2018/04/04/automatic-versionning-in-visual-studio/add_as_link.png">
</li>
</ul>
<p>这样所有project都会共享SharedInfo文件。</p>
<h2 id="使用T4模板生成版本号"><a href="#使用T4模板生成版本号" class="headerlink" title="使用T4模板生成版本号"></a>使用T4模板生成版本号</h2><p>在AssemblyVersion属性中使用通配符生成的版本号并不是那么“友好”。有的时候仅仅是想让版本号加一而已。使用T4(<strong>Text Template Transformation Toolkit</strong>)模板自动生成代码可以做到这一点。</p>
<blockquote>
<p>In Visual Studio, a <em>T4 text template</em> is a mixture of text blocks and control logic that can generate a text file.</p>
</blockquote>
<blockquote>
<p>T4 is used by developers as part of an application or tool framework to automate the creation of text files with a variety of parameters. These text files can ultimately be any text format, such as code (for example C#), XML, HTML or XAML.</p>
</blockquote>
<p>在vs中创建一个SharedInfo.tt文件(new -&gt;item -&gt; text template)，加入以下内容:</p>
<figure class="highlight csharp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br></pre></td><td class="code"><pre><span class="line">&lt;<span class="meta">#@ template debug="false" hostspecific="true" language="C#" #&gt;</span></span><br><span class="line">&lt;<span class="meta">#@ import namespace="System.IO" #&gt;</span></span><br><span class="line">&lt;<span class="meta">#@ output extension=".cs" #&gt;</span></span><br><span class="line">&lt;<span class="meta">#</span></span><br><span class="line">     <span class="keyword">int</span> major = <span class="number">0</span>; </span><br><span class="line">     <span class="keyword">int</span> minor = <span class="number">0</span>; </span><br><span class="line">     <span class="keyword">int</span> build = <span class="number">0</span>; </span><br><span class="line">     <span class="keyword">int</span> revision = <span class="number">0</span>; </span><br><span class="line">  </span><br><span class="line">     <span class="keyword">try</span></span><br><span class="line">     &#123;</span><br><span class="line">         <span class="keyword">using</span>(<span class="keyword">var</span> f = File.OpenText(Host.ResolvePath(<span class="string">"SharedInfo.cs"</span>)))</span><br><span class="line">         &#123;</span><br><span class="line">             <span class="keyword">string</span> maj = f.ReadLine().Replace(<span class="string">"//"</span>,<span class="string">""</span>);</span><br><span class="line">             <span class="keyword">string</span> min = f.ReadLine().Replace(<span class="string">"//"</span>,<span class="string">""</span>);</span><br><span class="line">             <span class="keyword">string</span> b = f.ReadLine().Replace(<span class="string">"//"</span>,<span class="string">""</span>);</span><br><span class="line">             <span class="keyword">string</span> r = f.ReadLine().Replace(<span class="string">"//"</span>,<span class="string">""</span>);</span><br><span class="line">  </span><br><span class="line">             major = <span class="keyword">int</span>.Parse(maj); </span><br><span class="line">             minor = <span class="keyword">int</span>.Parse(min); </span><br><span class="line">             build = <span class="keyword">int</span>.Parse(b); </span><br><span class="line">             revision = <span class="keyword">int</span>.Parse(r) + <span class="number">1</span>; </span><br><span class="line">         &#125;</span><br><span class="line">     &#125;</span><br><span class="line">     <span class="keyword">catch</span></span><br><span class="line">     &#123;</span><br><span class="line">         major = <span class="number">1</span>; </span><br><span class="line">         minor = <span class="number">0</span>; </span><br><span class="line">         build = <span class="number">0</span>; </span><br><span class="line">         revision = <span class="number">0</span>; </span><br><span class="line">     &#125;</span><br><span class="line"> <span class="meta">#&gt;</span></span><br><span class="line"> <span class="comment">//&lt;#= major #&gt;</span></span><br><span class="line"> <span class="comment">//&lt;#= minor #&gt;</span></span><br><span class="line"> <span class="comment">//&lt;#= build #&gt;</span></span><br><span class="line"> <span class="comment">//&lt;#= revision #&gt;</span></span><br><span class="line"> <span class="comment">// </span></span><br><span class="line"> <span class="comment">// This code was generated by a tool. Any changes made manually will be lost</span></span><br><span class="line"> <span class="comment">// the next time this code is regenerated.</span></span><br><span class="line"> <span class="comment">// </span></span><br><span class="line">  </span><br><span class="line"> <span class="keyword">using</span> System.Reflection;</span><br><span class="line">  </span><br><span class="line"> [<span class="meta">assembly: AssemblyFileVersion(<span class="meta-string">"&lt;#= major #&gt;.&lt;#= minor #&gt;.&lt;#= build #&gt;.&lt;#= revision #&gt;"</span>)</span>]</span><br></pre></td></tr></table></figure>
<p>保存之后，会在SharedInfo.tt文件下面生成SharedInfo.cs文件。然后将该文件通过add as link 加入到其他project中。这样每次要生成一个新的版本号之后，需要在SharedInfo.tt文件的右键菜单中<code>Run Custom tool</code>，重新生成SharedInfo.cs文件。</p>
<p>当然也可以在使用pre-build事件，自动化这一过程。在project的pre-build事件中加入以下内容：</p>
<figure class="highlight bat"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="built_in">set</span> textTemplatingPath="<span class="variable">%CommonProgramFiles(x86)%</span>\Microsoft Shared\TextTemplating\$(VisualStudioVersion)\texttransform.exe"</span><br><span class="line"><span class="keyword">if</span> <span class="variable">%textTemplatingPath%</span>=="\Microsoft Shared\TextTemplating\$(VisualStudioVersion)\texttransform.exe" <span class="built_in">set</span> textTemplatingPath="<span class="variable">%CommonProgramFiles%</span>\Microsoft Shared\TextTemplating\$(VisualStudioVersion)\texttransform.exe"</span><br><span class="line"><span class="variable">%textTemplatingPath%</span> "$(ProjectDir)SharedInfo.tt"</span><br></pre></td></tr></table></figure>
<img src="/2018/04/04/automatic-versionning-in-visual-studio/pre_build.png">
<h2 id="使用VS插件Automatic-Versions-1"><a href="#使用VS插件Automatic-Versions-1" class="headerlink" title="使用VS插件Automatic Versions 1"></a>使用VS插件Automatic Versions 1</h2><p>最简单也是最强大的莫过于直接使用<a href="https://marketplace.visualstudio.com/items?itemName=PrecisionInfinity.AutomaticVersions" target="_blank" rel="noopener">Automatic Versions</a>插件了。该VS插件提供了多种策略来实现版本号自动递增，可以支持整个solution和单个project的versioning继承。即可以为整个solution设置versionning的规则，也可以为单个project设置不继承solution的规则，自己按自己的规则。</p>
<p>安装好之后，在vs菜单栏tools -&gt; automatic versions settings，打开设置面板。</p>

<p>设置选项参考官方的文档：</p>
<blockquote>
<p>CustomSystem.Version Options</p>
<p>Major, Minor, Build, andRevision can be individually configured to the incrementation type desired:</p>
<img src="/2018/04/04/automatic-versionning-in-visual-studio/clip_image001.png">
<p>In these examples, we usethe date July 29th 2024, 1:30pm</p>
<ul>
<li>None -     Do not increment this value.</li>
<li>Increment (Always) - Always Increments this value by 1*</li>
<li>Increment w/AutoReset - Increments this value by     1, unless a more significant number increases, in which case it will reset     to 0.</li>
<li>On Demand (Build New     Version) - Increment this value     by 1 only when a build is initiated using the Build New Version command (on the     context menu of each project). You can set this value on both the Major     and the Minor numbers and use the context menu (see usage below) to     control which one is incremented.</li>
<li>On Demand w/Reset (Obsolete) - Use Increment w/AutoReset instead.     This feature may not be supported in future versions of the product.     (Legacy functionality: Increment this value by 1 only when a build is     initiated using the Build New Version command (on the context menu of each     project). Resets all Increment sub-values.)</li>
<li>Day Of Year (ddd) - Set this value to DateTime.UtcNow.DayOfYear:     211.</li>
<li>Day (dd) -     Set this value to the current day of the month: 29.</li>
<li>Month (MM) - Set this value to the current month of the year:     7.</li>
<li>Year (yyyy) - Set this value to the current year: 2024.</li>
<li>Short Year (yy) - Set this value to 2 digit     current year: 24.</li>
<li>Date (yyddd) - Set this value to the current date (yyddd format     - where ddd is the day of year)**: 24211.</li>
<li>Date (MMdd) - Set this value to the     current date (MMdd) where MM is a 2-digit month and dd is a 2-digit day of     month: 0729.</li>
<li>UTC Time (HHmm) - Set this value to the current time (HHmm     format): 1330.</li>
<li>Delta Days (since 1/1/2000) - Set this value to the number of days that have     occurred since January 1, 2000: 8976.</li>
<li>UTC Seconds Since Midnight/2 - If you are using a custom     unique time based stamp for your version number, this gives you the most     granularity to a single day. The number has to be divided by 2 so it     doesn’t overflow the max value.</li>
</ul>
<p>*There is an exception to this rule whenIncrement On Demand w/Reset (Obsolete) is used it will reset this value if youchoose Build New Version</p>
<p>**This value will overflow in 2065. Since itis very useful and there are limited alternatives that work as well as thisone, we are continuing to use it and even recommend using it, however, we maychange it’s functionality at some point such that it does not overflow in 2065.The overflow itself is not a security issue, however. It will only cause abuild error.</p>
<p>CustomSemantic Version (BETA/PRO)</p>
<p>Semantic Versioning istypically used for ‘packaging’ the results of a build for use in a manifestfile or as a ‘published package’ of your product. Therefore Semantic Versioningleverages the other version attributes by letting you choose which of those youwant to use for your Major/Minor numbers, and independently does it’s ownincrementation on the Patch and Pre-Release numbers.</p>
<img src="/2018/04/04/automatic-versionning-in-visual-studio/clip_image002.png">
<ul>
<li>Major/Minor settings - Set to use     AssemblyVersion, AssemblyFileVersion, or Set Manually. To set manually,     open the AssemblyInfo file (for Full .Net) or the project properties (for     .Net Standard/Core) and manually set the major and minor values.</li>
<li>Patch settings - This will increment the     Patch number based on the incrementation settings. Increment Once is     available for when you switch to a ‘pre-release’ version of the product,     you will typically want the Patch number to Increment Once for the start     of your pre-release cycle. After incrementing once, this setting will     automatically update to None (whereby Pre-Release will be doing the     incrementation).</li>
<li>Pre-Release (optional) - Set to alpha, beta,     preview, rc, or N/A (release). If you set a pre-release, then Patch will     automatically change to “increment once” for you and the     prerelease will increment instead starting with alpha, then alpha-01,     alpha-02, etc. When you set this to (N/A release) then Patch will be     automatically changed to Increment w/AutoReset for you.</li>
</ul>
</blockquote>
<p>注意一点：</p>
<p>OnDemand 表示在工程的右键菜单中手动选择build</p>
<img src="/2018/04/04/automatic-versionning-in-visual-studio/on_demand.png">
<h2 id="参考链接"><a href="#参考链接" class="headerlink" title="参考链接"></a>参考链接</h2><ul>
<li><a href="https://jonthysell.com/2017/01/10/automatically-generating-version-numbers-in-visual-studio/" target="_blank" rel="noopener">https://jonthysell.com/2017/01/10/automatically-generating-version-numbers-in-visual-studio/</a></li>
<li><a href="https://marketplace.visualstudio.com/items?itemName=PrecisionInfinity.AutomaticVersions" target="_blank" rel="noopener">https://marketplace.visualstudio.com/items?itemName=PrecisionInfinity.AutomaticVersions</a></li>
<li><a href="https://weblogs.asp.net/kon/assembly-file-version-auto-increment-magic" target="_blank" rel="noopener">https://weblogs.asp.net/kon/assembly-file-version-auto-increment-magic</a></li>
<li><a href="https://docs.microsoft.com/en-us/visualstudio/modeling/code-generation-and-t4-text-templates" target="_blank" rel="noopener">https://docs.microsoft.com/en-us/visualstudio/modeling/code-generation-and-t4-text-templates</a></li>
</ul>

      
    </div>

    
      


    

    
    
    

    

    

    
      <div>
        <ul class="post-copyright">
  <li class="post-copyright-author">
    <strong>本文作者： </strong>byGeek</li>
  <li class="post-copyright-link">
    <strong>本文链接：</strong>
    <a href="https://bygeek.cn/2018/04/04/automatic-versionning-in-visual-studio/" title="visual studio中版本号自动管理">https://bygeek.cn/2018/04/04/automatic-versionning-in-visual-studio/</a>
  </li>
  <li class="post-copyright-license">
    <strong>版权声明： </strong>本博客所有文章除特别声明外，均采用 <a href="https://creativecommons.org/licenses/by-nc-sa/4.0/" rel="external nofollow" target="_blank">CC BY-NC-SA 4.0</a> 许可协议。转载请注明出处！</li>
</ul>

      </div>
    

    <footer class="post-footer">
      
        <div class="post-tags">
          
            <a href="/tags/visual-studio/" rel="tag"># visual studio</a>
          
        </div>
      

      
      
      

      
        <div class="post-nav">
          <div class="post-nav-next post-nav-item">
            
              <a href="/2018/04/04/visual-studio-is-in-break-mode/" rel="next" title="visual studio:应用程序处于中断模式">
                <i class="fa fa-chevron-left"></i> visual studio:应用程序处于中断模式
              </a>
            
          </div>

          <span class="post-nav-divider"></span>

          <div class="post-nav-prev post-nav-item">
            
              <a href="/2018/04/05/simple-spy-tutorial/" rel="prev" title="spy++简单教程">
                spy++简单教程 <i class="fa fa-chevron-right"></i>
              </a>
            
          </div>
        </div>
      

      
      
    </footer>
  </div>
  
  
  
  </article>


  </div>


          </div>
          

  
    <div class="comments" id="comments">
    </div>
  



        </div>
        
          
  
  <div class="sidebar-toggle">
    <div class="sidebar-toggle-line-wrap">
      <span class="sidebar-toggle-line sidebar-toggle-line-first"></span>
      <span class="sidebar-toggle-line sidebar-toggle-line-middle"></span>
      <span class="sidebar-toggle-line sidebar-toggle-line-last"></span>
    </div>
  </div>

  <aside id="sidebar" class="sidebar">
    
    <div class="sidebar-inner">

      

      
        <ul class="sidebar-nav motion-element">
          <li class="sidebar-nav-toc sidebar-nav-active" data-target="post-toc-wrap">
            文章目录
          </li>
          <li class="sidebar-nav-overview" data-target="site-overview-wrap">
            站点概览
          </li>
        </ul>
      

      <section class="site-overview-wrap sidebar-panel">
        <div class="site-overview">
          <div class="site-author motion-element" itemprop="author" itemscope itemtype="http://schema.org/Person">
            
              <img class="site-author-image" itemprop="image" src="/uploads/avatar.jpg" alt="byGeek">
            
              <p class="site-author-name" itemprop="name">byGeek</p>
              <p class="site-description motion-element" itemprop="description">Never too late to lose weight!!!</p>
          </div>

          
            <nav class="site-state motion-element">
              
                <div class="site-state-item site-state-posts">
                
                  <a href="/archives/">
                
                    <span class="site-state-item-count">67</span>
                    <span class="site-state-item-name">日志</span>
                  </a>
                </div>
              

              
                
                
                <div class="site-state-item site-state-categories">
                  <a href="/categories/index.html">
                    
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                    <span class="site-state-item-count">7</span>
                    <span class="site-state-item-name">分类</span>
                  </a>
                </div>
              

              
                
                
                <div class="site-state-item site-state-tags">
                  <a href="/tags/index.html">
                    
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                    <span class="site-state-item-count">43</span>
                    <span class="site-state-item-name">标签</span>
                  </a>
                </div>
              
            </nav>
          

          
            <div class="feed-link motion-element">
              <a href="/atom.xml" rel="alternate">
                <i class="fa fa-rss"></i>
                RSS
              </a>
            </div>
          

          
            <div class="links-of-author motion-element">
              
                <span class="links-of-author-item">
                  <a href="https://github.com/byGeek" target="_blank" title="GitHub" rel="external nofollow"><i class="fa fa-fw fa-github"></i>GitHub</a>
                  
                </span>
              
                <span class="links-of-author-item">
                  <a href="mailto:byyangatchina@live.cn" target="_blank" title="E-Mail" rel="external nofollow"><i class="fa fa-fw fa-envelope"></i>E-Mail</a>
                  
                </span>
              
            </div>
          

          
          

          
          

          
            
          
          

        </div>
      </section>

      
      <!--noindex-->
        <section class="post-toc-wrap motion-element sidebar-panel sidebar-panel-active">
          <div class="post-toc">

            
              
            

            
              <div class="post-toc-content"><ol class="nav"><li class="nav-item nav-level-2"><a class="nav-link" href="#前言"><span class="nav-number">1.</span> <span class="nav-text">前言</span></a></li><li class="nav-item nav-level-2"><a class="nav-link" href="#利用VS自带的版本号递增"><span class="nav-number">2.</span> <span class="nav-text">利用VS自带的版本号递增</span></a></li><li class="nav-item nav-level-2"><a class="nav-link" href="#使用T4模板生成版本号"><span class="nav-number">3.</span> <span class="nav-text">使用T4模板生成版本号</span></a></li><li class="nav-item nav-level-2"><a class="nav-link" href="#使用VS插件Automatic-Versions-1"><span class="nav-number">4.</span> <span class="nav-text">使用VS插件Automatic Versions 1</span></a></li><li class="nav-item nav-level-2"><a class="nav-link" href="#参考链接"><span class="nav-number">5.</span> <span class="nav-text">参考链接</span></a></li></ol></div>
            

          </div>
        </section>
      <!--/noindex-->
      

      

    </div>
  </aside>


        
      </div>
    </main>

    <footer id="footer" class="footer">
      <div class="footer-inner">
        <div class="copyright">&copy; 2017 – <span itemprop="copyrightYear">2020</span>
  <span class="with-love" id="animate">
    <i class="fa fa-user"></i>
  </span>
  <span class="author" itemprop="copyrightHolder">byGeek</span>

  

  
</div>


  









  <div class="footer-custom"><a target="_blank" href="http://www.beian.miit.gov.cn">苏ICP备18025743号</a></div>


        








        
      </div>
    </footer>

    
      <div class="back-to-top">
        <i class="fa fa-arrow-up"></i>
        
      </div>
    

    
	
    

    
  </div>

  

<script type="text/javascript">
  if (Object.prototype.toString.call(window.Promise) !== '[object Function]') {
    window.Promise = null;
  }
</script>
























  



  
  
    <script type="text/javascript" src="/lib/jquery/index.js?v=2.1.3"></script>
  

  
  
    <script type="text/javascript" src="/lib/velocity/velocity.min.js?v=1.2.1"></script>
  

  
  
    <script type="text/javascript" src="/lib/velocity/velocity.ui.min.js?v=1.2.1"></script>
  

  
  
    <script type="text/javascript" src="/lib/reading_progress/reading_progress.js"></script>
  


  


  <script type="text/javascript" src="/js/src/utils.js?v=6.4.0"></script>

  <script type="text/javascript" src="/js/src/motion.js?v=6.4.0"></script>



  
  

  
  <script type="text/javascript" src="/js/src/scrollspy.js?v=6.4.0"></script>
<script type="text/javascript" src="/js/src/post-details.js?v=6.4.0"></script>



  


  <script type="text/javascript" src="/js/src/bootstrap.js?v=6.4.0"></script>



  



  








  <script src="//cdn1.lncld.net/static/js/3.0.4/av-min.js"></script>
  
  
  <script src="//unpkg.com/valine/dist/Valine.min.js"></script>
  
  <script type="text/javascript">
    var GUEST = ['nick','mail','link'];
    var guest = 'nick,mail,link';
    guest = guest.split(',').filter(function (item) {
      return GUEST.indexOf(item)>-1;
    });
    new Valine({
        el: '#comments' ,
        verify: false,
        notify: true,
        appId: 'OoFjPP6mvjRPyMkCtu8VuHVA-gzGzoHsz',
        appKey: 'fqepceL0pcOioAq6hp7MKGeu',
        placeholder: '来啊，快活啊!',
        avatar:'mm',
        meta:guest,
        pageSize:'10' || 10,
        visitor: false
    });
  </script>



  

  <script type="text/javascript">
    // Popup Window;
    var isfetched = false;
    var isXml = true;
    // Search DB path;
    var search_path = "search.xml";
    if (search_path.length === 0) {
      search_path = "search.xml";
    } else if (/json$/i.test(search_path)) {
      isXml = false;
    }
    var path = "/" + search_path;
    // monitor main search box;

    var onPopupClose = function (e) {
      $('.popup').hide();
      $('#local-search-input').val('');
      $('.search-result-list').remove();
      $('#no-result').remove();
      $(".local-search-pop-overlay").remove();
      $('body').css('overflow', '');
    }

    function proceedsearch() {
      $("body")
        .append('<div class="search-popup-overlay local-search-pop-overlay"></div>')
        .css('overflow', 'hidden');
      $('.search-popup-overlay').click(onPopupClose);
      $('.popup').toggle();
      var $localSearchInput = $('#local-search-input');
      $localSearchInput.attr("autocapitalize", "none");
      $localSearchInput.attr("autocorrect", "off");
      $localSearchInput.focus();
    }

    // search function;
    var searchFunc = function(path, search_id, content_id) {
      'use strict';

      // start loading animation
      $("body")
        .append('<div class="search-popup-overlay local-search-pop-overlay">' +
          '<div id="search-loading-icon">' +
          '<i class="fa fa-spinner fa-pulse fa-5x fa-fw"></i>' +
          '</div>' +
          '</div>')
        .css('overflow', 'hidden');
      $("#search-loading-icon").css('margin', '20% auto 0 auto').css('text-align', 'center');

      

      $.ajax({
        url: path,
        dataType: isXml ? "xml" : "json",
        async: true,
        success: function(res) {
          // get the contents from search data
          isfetched = true;
          $('.popup').detach().appendTo('.header-inner');
          var datas = isXml ? $("entry", res).map(function() {
            return {
              title: $("title", this).text(),
              content: $("content",this).text(),
              url: $("url" , this).text()
            };
          }).get() : res;
          var input = document.getElementById(search_id);
          var resultContent = document.getElementById(content_id);
          var inputEventFunction = function() {
            var searchText = input.value.trim().toLowerCase();
            var keywords = searchText.split(/[\s\-]+/);
            if (keywords.length > 1) {
              keywords.push(searchText);
            }
            var resultItems = [];
            if (searchText.length > 0) {
              // perform local searching
              datas.forEach(function(data) {
                var isMatch = false;
                var hitCount = 0;
                var searchTextCount = 0;
                var title = data.title.trim();
                var titleInLowerCase = title.toLowerCase();
                var content = data.content.trim().replace(/<[^>]+>/g,"");
                
                var contentInLowerCase = content.toLowerCase();
                var articleUrl = decodeURIComponent(data.url);
                var indexOfTitle = [];
                var indexOfContent = [];
                // only match articles with not empty titles
                if(title != '') {
                  keywords.forEach(function(keyword) {
                    function getIndexByWord(word, text, caseSensitive) {
                      var wordLen = word.length;
                      if (wordLen === 0) {
                        return [];
                      }
                      var startPosition = 0, position = [], index = [];
                      if (!caseSensitive) {
                        text = text.toLowerCase();
                        word = word.toLowerCase();
                      }
                      while ((position = text.indexOf(word, startPosition)) > -1) {
                        index.push({position: position, word: word});
                        startPosition = position + wordLen;
                      }
                      return index;
                    }

                    indexOfTitle = indexOfTitle.concat(getIndexByWord(keyword, titleInLowerCase, false));
                    indexOfContent = indexOfContent.concat(getIndexByWord(keyword, contentInLowerCase, false));
                  });
                  if (indexOfTitle.length > 0 || indexOfContent.length > 0) {
                    isMatch = true;
                    hitCount = indexOfTitle.length + indexOfContent.length;
                  }
                }

                // show search results

                if (isMatch) {
                  // sort index by position of keyword

                  [indexOfTitle, indexOfContent].forEach(function (index) {
                    index.sort(function (itemLeft, itemRight) {
                      if (itemRight.position !== itemLeft.position) {
                        return itemRight.position - itemLeft.position;
                      } else {
                        return itemLeft.word.length - itemRight.word.length;
                      }
                    });
                  });

                  // merge hits into slices

                  function mergeIntoSlice(text, start, end, index) {
                    var item = index[index.length - 1];
                    var position = item.position;
                    var word = item.word;
                    var hits = [];
                    var searchTextCountInSlice = 0;
                    while (position + word.length <= end && index.length != 0) {
                      if (word === searchText) {
                        searchTextCountInSlice++;
                      }
                      hits.push({position: position, length: word.length});
                      var wordEnd = position + word.length;

                      // move to next position of hit

                      index.pop();
                      while (index.length != 0) {
                        item = index[index.length - 1];
                        position = item.position;
                        word = item.word;
                        if (wordEnd > position) {
                          index.pop();
                        } else {
                          break;
                        }
                      }
                    }
                    searchTextCount += searchTextCountInSlice;
                    return {
                      hits: hits,
                      start: start,
                      end: end,
                      searchTextCount: searchTextCountInSlice
                    };
                  }

                  var slicesOfTitle = [];
                  if (indexOfTitle.length != 0) {
                    slicesOfTitle.push(mergeIntoSlice(title, 0, title.length, indexOfTitle));
                  }

                  var slicesOfContent = [];
                  while (indexOfContent.length != 0) {
                    var item = indexOfContent[indexOfContent.length - 1];
                    var position = item.position;
                    var word = item.word;
                    // cut out 100 characters
                    var start = position - 20;
                    var end = position + 80;
                    if(start < 0){
                      start = 0;
                    }
                    if (end < position + word.length) {
                      end = position + word.length;
                    }
                    if(end > content.length){
                      end = content.length;
                    }
                    slicesOfContent.push(mergeIntoSlice(content, start, end, indexOfContent));
                  }

                  // sort slices in content by search text's count and hits' count

                  slicesOfContent.sort(function (sliceLeft, sliceRight) {
                    if (sliceLeft.searchTextCount !== sliceRight.searchTextCount) {
                      return sliceRight.searchTextCount - sliceLeft.searchTextCount;
                    } else if (sliceLeft.hits.length !== sliceRight.hits.length) {
                      return sliceRight.hits.length - sliceLeft.hits.length;
                    } else {
                      return sliceLeft.start - sliceRight.start;
                    }
                  });

                  // select top N slices in content

                  var upperBound = parseInt('1');
                  if (upperBound >= 0) {
                    slicesOfContent = slicesOfContent.slice(0, upperBound);
                  }

                  // highlight title and content

                  function highlightKeyword(text, slice) {
                    var result = '';
                    var prevEnd = slice.start;
                    slice.hits.forEach(function (hit) {
                      result += text.substring(prevEnd, hit.position);
                      var end = hit.position + hit.length;
                      result += '<b class="search-keyword">' + text.substring(hit.position, end) + '</b>';
                      prevEnd = end;
                    });
                    result += text.substring(prevEnd, slice.end);
                    return result;
                  }

                  var resultItem = '';

                  if (slicesOfTitle.length != 0) {
                    resultItem += "<li><a href='" + articleUrl + "' class='search-result-title'>" + highlightKeyword(title, slicesOfTitle[0]) + "</a>";
                  } else {
                    resultItem += "<li><a href='" + articleUrl + "' class='search-result-title'>" + title + "</a>";
                  }

                  slicesOfContent.forEach(function (slice) {
                    resultItem += "<a href='" + articleUrl + "'>" +
                      "<p class=\"search-result\">" + highlightKeyword(content, slice) +
                      "...</p>" + "</a>";
                  });

                  resultItem += "</li>";
                  resultItems.push({
                    item: resultItem,
                    searchTextCount: searchTextCount,
                    hitCount: hitCount,
                    id: resultItems.length
                  });
                }
              })
            };
            if (keywords.length === 1 && keywords[0] === "") {
              resultContent.innerHTML = '<div id="no-result"><i class="fa fa-search fa-5x" /></div>'
            } else if (resultItems.length === 0) {
              resultContent.innerHTML = '<div id="no-result"><i class="fa fa-frown-o fa-5x" /></div>'
            } else {
              resultItems.sort(function (resultLeft, resultRight) {
                if (resultLeft.searchTextCount !== resultRight.searchTextCount) {
                  return resultRight.searchTextCount - resultLeft.searchTextCount;
                } else if (resultLeft.hitCount !== resultRight.hitCount) {
                  return resultRight.hitCount - resultLeft.hitCount;
                } else {
                  return resultRight.id - resultLeft.id;
                }
              });
              var searchResultList = '<ul class=\"search-result-list\">';
              resultItems.forEach(function (result) {
                searchResultList += result.item;
              })
              searchResultList += "</ul>";
              resultContent.innerHTML = searchResultList;
            }
          }

          if ('auto' === 'auto') {
            input.addEventListener('input', inputEventFunction);
          } else {
            $('.search-icon').click(inputEventFunction);
            input.addEventListener('keypress', function (event) {
              if (event.keyCode === 13) {
                inputEventFunction();
              }
            });
          }

          // remove loading animation
          $(".local-search-pop-overlay").remove();
          $('body').css('overflow', '');

          proceedsearch();
        }
      });
    }

    // handle and trigger popup window;
    $('.popup-trigger').click(function(e) {
      e.stopPropagation();
      if (isfetched === false) {
        searchFunc(path, 'local-search-input', 'local-search-result');
      } else {
        proceedsearch();
      };
    });

    $('.popup-btn-close').click(onPopupClose);
    $('.popup').click(function(e){
      e.stopPropagation();
    });
    $(document).on('keyup', function (event) {
      var shouldDismissSearchPopup = event.which === 27 &&
        $('.search-popup').is(':visible');
      if (shouldDismissSearchPopup) {
        onPopupClose();
      }
    });
  </script>





  

  

  
<script>
(function(){
    var bp = document.createElement('script');
    var curProtocol = window.location.protocol.split(':')[0];
    if (curProtocol === 'https') {
        bp.src = 'https://zz.bdstatic.com/linksubmit/push.js';        
    }
    else {
        bp.src = 'http://push.zhanzhang.baidu.com/push.js';
    }
    var s = document.getElementsByTagName("script")[0];
    s.parentNode.insertBefore(bp, s);
})();
</script>


  

  
  

  

  

  

  

  
  <style>
    .copy-btn {
      display: inline-block;
      padding: 6px 12px;
      font-size: 13px;
      font-weight: 700;
      line-height: 20px;
      color: #333;
      white-space: nowrap;
      vertical-align: middle;
      cursor: pointer;
      background-color: #eee;
      background-image: linear-gradient(#fcfcfc, #eee);
      border: 1px solid #d5d5d5;
      border-radius: 3px;
      user-select: none;
      outline: 0;
    }

    .highlight-wrap .copy-btn {
      transition: opacity .3s ease-in-out;
      opacity: 0;
      padding: 2px 6px;
      position: absolute;
      right: 4px;
      top: 8px;
    }

    .highlight-wrap:hover .copy-btn,
    .highlight-wrap .copy-btn:focus {
      opacity: 1
    }

    .highlight-wrap {
      position: relative;
    }
  </style>
  <script>
    $('.highlight').each(function (i, e) {
      var $wrap = $('<div>').addClass('highlight-wrap')
      $(e).after($wrap)
      $wrap.append($('<button>').addClass('copy-btn').append('复制').on('click', function (e) {
        var code = $(this).parent().find('.code').find('.line').map(function (i, e) {
          return $(e).text()
        }).toArray().join('\n')
        var ta = document.createElement('textarea')
        document.body.appendChild(ta)
        ta.style.position = 'absolute'
        ta.style.top = '0px'
        ta.style.left = '0px'
        ta.value = code
        ta.select()
        ta.focus()
        var result = document.execCommand('copy')
        document.body.removeChild(ta)
        
          if(result)$(this).text('复制成功')
          else $(this).text('复制失败')
        
        $(this).blur()
      })).on('mouseleave', function (e) {
        var $b = $(this).find('.copy-btn')
        setTimeout(function () {
          $b.text('复制')
        }, 300)
      }).append(e)
    })
  </script>


</body>
</html>
